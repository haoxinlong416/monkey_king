# Linux

## 配置RAID

### RAID 0（无冗余，最快）

1.创建RAID0

![微信图片_20240909161349](%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240909161349.png)

2.初始化物理卷

![微信图片_20240909161403](%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240909161403.png)

3.创建卷组

![微信图片_20240909161408](%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240909161408.png)

4.创建逻辑卷

![微信图片_20240909161415](%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240909161415.png)

5.格式化逻辑卷并挂载

![微信图片_20240909161421](%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240909161421.png)

6.创建data

![微信图片_20240909161425](%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240909161425.png)

7.挂载

![微信图片_20240909161429](%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240909161429.png)

8.安装quota

![微信图片_20240909161433](%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240909161433.png)

9.配置fstab

![微信图片_20240909161438](%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240909161438.png)

10.重新挂载并重启虚拟机

![微信图片_20240909161442](%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240909161442.png)

11.启用磁盘配额

![微信图片_20240909161446](%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240909161446.png)

12.使用edquota为用户和组配置配额

![微信图片_20240909163013](%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240909163013.png)

13.验证配额状态

![微信图片_20240909161459](%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240909161459.png)

### RAID 1（镜像，数据冗余）

1.添加硬盘，增加三块硬盘

![屏幕截图 2024-09-09 175417](%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-09-09%20175417.jpg)

2.查看硬盘是否添加

![屏幕截图 2024-09-09 175600](%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-09-09%20175600.jpg)

3.配置第三块硬盘

![屏幕截图 2024-09-09 175650](%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-09-09%20175650.jpg)

4.创建RAID1

![屏幕截图 2024-09-09 175823](%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-09-09%20175823.jpg)

![屏幕截图 2024-09-09 175843](%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-09-09%20175843.jpg)

5.再次查看具体信息，显示磁盘状态

![屏幕截图 2024-09-09 180018](%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-09-09%20180018.jpg)

6.格式化RAID1卷

![屏幕截图 2024-09-09 180115](%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-09-09%20180115.jpg)

7.挂载并查看是否挂载成功

![屏幕截图 2024-09-09 180215](%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-09-09%20180215.jpg)

![屏幕截图 2024-09-09 180249](%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-09-09%20180249.jpg)

8.测试RAID1的性能（模拟磁盘损坏）

![屏幕截图 2024-09-09 181018](%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-09-09%20181018.jpg)

![屏幕截图 2024-09-09 181224](%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-09-09%20181224.jpg)

![屏幕截图 2024-09-09 181111](%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-09-09%20181111.jpg)

![屏幕截图 2024-09-09 181305](%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-09-09%20181305.jpg)

文件无损失即为热备盘自动补充

9.设置磁盘配额，检查内核模块

```shell
$ sudo modprobe quota_v1
$ sudo modprobe quota_v2
```

10.准备文件系统

```shell
$ sudo mount -o remount,usrquota /dev/sda1
```

11.创建配额数据库

```shell 
$ sudo quotacheck -cug /dev/sda1
```

12.启用配额功能

```shell
$ sudo quotaon /dev/sda1
```

13.设置用户配额

```shell 
$ sudo edquota -u username
```

14.检查配额使用情况

```shell 
$ sudo repquota -a
```

15.对配额进行测试

### RAID 5（至少3个磁盘，有冗余）

1.创建并查看硬盘

![微信图片_20240909164138](%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240909164138.png)

![微信图片_20240909164142](%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240909164142.png)

2.对磁盘进行逐个配置

![微信图片_20240909164409](%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240909164409.png)

3.更改文件类型配置磁盘

![微信图片_20240909164515](%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240909164515.png)

![微信图片_20240909164520](%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240909164520.png)

![微信图片_20240909164528](%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240909164528.png)

![微信图片_20240909164533](%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240909164533.png)

4.查看各个硬盘

![微信图片_20240909164524](%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240909164524.png)

![微信图片_20240909164544](%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240909164544.png)

5.查看RAID 5的详细信息

![微信图片_20240909164600](%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240909164600.png)

6.再次查看启动状态及详细信息

![微信图片_20240909164604](%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240909164604.png)

![微信图片_20240909164611](%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240909164611.png)

7.格式化挂载及自动挂载

![微信图片_20240909164615](%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240909164615.png)

8.保存RAID5配置

![微信图片_20240909164632](%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240909164632.png)

9.创建pv

![微信图片_20240909164654](%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240909164654.png)

10.创建卷组

![微信图片_20240909164702](%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240909164702.png)

11.创建lv

![微信图片_20240909164708](%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240909164708.png)

12.格式化lv挂载使用，将这两个lv格式化为ext4\xfs,开机自动挂载到系统mnt1,mnt2目录下

![微信图片_20240909164712](%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240909164712.png)

![微信图片_20240909164719](%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240909164719.png)

![微信图片_20240909164749](%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240909164749.png)

13.检查磁盘配额开启是否成功

![微信图片_20240909164754](%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240909164754.png)

![微信图片_20240909164811](%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240909164811.png)

![微信图片_20240909164841](%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240909164841.png)

14.在系统里添加用户hxl,wzh并加入RAID5

![微信图片_20240909164848](%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240909164848.png)

![微信图片_20240909164857](%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240909164857.png)

15.开启磁盘配额功能，用来进行用户与组分配额的实验

![微信图片_20240909165025](%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240909165025.png)

![微信图片_20240909165029](%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240909165029.png)

16.赋予权限

![微信图片_20240909165036](%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240909165036.png)

17.打开文件查看

![微信图片_20240909165040](%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240909165040.png)

![微信图片_20240909165049](%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240909165049.png)

![微信图片_20240909165100](%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240909165100.png)

18.验证用户的磁盘配额限制

![微信图片_20240909165107](%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240909165107.png)